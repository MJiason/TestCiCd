before_install:
  - chmod +x ./mvnw

language: java

deploy:
  provider: heroku
  api-key: $HEROKU_API_KEY
  app: test-travis-ci-cd

branches:
  only:
    - master


notifications:
  slack: lll-dsi3462:pP6YA8n1oxveDKsT2yxp6GTC
  on_success: always  # change: send a notification when the build status changes.
  on_failure: always  # always: always send a notification.
  template:
    - "Repo `%{repository_slug}` *%{result}* build (<%{build_url}|#%{build_number}>) for commit (<%{compare_url}|%{commit}>) on branch `%{branch}`."
    - "Execution time: *%{duration}*"
    - "Message: %{message}"

addons:
  sonarcloud:
    organization: mjiason
    token: "cN8NIcb1OJ9h/koV5tJYyfSRAKvM5v+tgL/LSzfKuPn6MRC+1rf51qpx6oojBXUuMAMeCqdq0PNfCpjWaUG3+dVnZSzcdksHwT4IbNtEgE4z8iqL7vCeYiCKrvEJv5wvsV9Wm51sDHEmJRHU0AVSmoNOp2hUgpMNru9nhnI8BTvRGTREC9G8jhsZSWrGU0ZUPV1Q4iUFqW7qtj7cO7FZwZenlpabbI89vb9dEjuF0BYuMtbyoTuNuYNcA6B4rm3i2kwKf6YXm7wbrZc+rbnLXQtbHh4TOVk6uRW1Nh+p1VyAA9CCVEwrCv5BHwcqm5AEE//CPDCUChPij/emE6nCw7XphjECn+lMqdwZiKvel6LPDLLjdoLnrDuL25qGL52k5wSk2aVXznKzzgj38ZqYk1HhUmtPfEOQwmkrfOVqfxf0xYiNVIlnvHkhJt2V0Mg5/Suto0aBVkToZB/RqJOavAIFBdimJfkWhHP/im1VgW4OkumTgfwvEr41Y2x4PNzinBNDJUFhPxYQHFAE3/BZhOXqc0F0HifSe5fYJJdhRhUJzTP7ecfnX97l9xNIrIBtTi0L4o6W0ucT4p23dJ8+iG8dlltSpavgLQGxe9tSGrgzmTzOuSmhJcizVVDb8osGhtMXn6MmTKZNx7+gKsRbANp6/HiyyOGJPMlimID+aAI="


script:
  # the following command line builds the project, runs the tests with coverage and then execute the SonarCloud analysis
  - mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar -Dsonar.projectKey=MJiason_TestCiCd